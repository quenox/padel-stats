function shareResultOnWhatsapp() {
    let mensaje = "🏆 Resultados del juego\n";
    mensaje += dateEndMatch + "\n\n";

    if (typeof gameState === 'undefined' || !gameState.players)
        mensaje += "No se pudieron cargar los resultados del juego.";
    else {
        const statsGeneral = gameState.players[0]?.stats; // Asumimos que todos tienen mismo total
        const totalPointsPlayed = statsGeneral ? statsGeneral.pointsWon + statsGeneral.pointsLost : 0;

        // Mostrar total una sola vez
        mensaje += `🎾 Total puntos jugados: ${totalPointsPlayed}\n\n`;

        gameState.players.forEach((player, index) => {
            const stats = player.stats;

            const personalEffectivity = (stats.W + stats.Ace + stats.UE + stats.DF) !== 0
                ? ((stats.W + stats.Ace) / (stats.W + stats.Ace + stats.UE + stats.DF) * 100).toFixed(1)
                : '0.0';

            const personalLosses = (stats.W + stats.Ace + stats.UE + stats.DF) !== 0
                ? ((stats.UE + stats.DF) / (stats.W + stats.Ace + stats.UE + stats.DF) * 100).toFixed(1)
                : '0.0';

            const percentageW = stats.pointsWon > 0
                ? ((stats.W + stats.Ace) / stats.pointsWon * 100).toFixed(1)
                : '0.0';

            const percentageUE = stats.pointsLost > 0
                ? ((stats.UE + stats.DF) / stats.pointsLost * 100).toFixed(1)
                : '0.0';

            if (index === 2)
                mensaje += `\n`;

            mensaje += `👤 ${player.name}\n`;
            mensaje += `✅ Winners: ${stats.W} | ⚠️ Errores N.F: ${stats.UE}\n`;
            mensaje += `🎯 Aces: ${stats.Ace} | ❌ Doble falta: ${stats.DF}\n`;
            mensaje += `📊 %Winners: ${percentageW}% | %Errores: ${percentageUE}%\n`;
            mensaje += `📈 Efectividad personal: ${personalEffectivity}% | Pérdidas personales: ${personalLosses}%\n\n`;
        });
    }

    mensaje += `Sets 👇\n`;
    mensaje += `${setTerminados.map((item, index) => `  * Set ${index + 1}👉${item}`).join('\n')}`;

    const url = "https://wa.me/?text=" + encodeURIComponent(mensaje);
    window.open(url, '_blank');
}
